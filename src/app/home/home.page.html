<ion-header class="ion-no-border" *ngIf="!showWelcomeScreen">
  <ion-toolbar color="light">
    <ion-title color="primary" class="ion-text-center">Lunar Languages</ion-title>
    <ion-buttons slot="end">
      <ion-button color="primary" (click)="openLanguageSelector()">
        <span *ngIf="currentLanguage" style="font-size: 1.5rem; margin-right: 4px;">{{ currentLanguage.flag }}</span>
        <ion-icon name="globe-outline" *ngIf="!currentLanguage"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="false" *ngIf="!showWelcomeScreen">

  <div class="display-wrapper ion-padding">
    <div class="glass-panel ion-padding ion-text-center">

      <p class="ion-text-uppercase ion-text-small text-muted ion-no-margin">
        {{ displayEnglish }}
      </p>

      <h1 class="text-hero-native">{{ displayNative }}</h1>

      <p class="text-phonetic">{{ displayPhonetic }}</p>

      <div class="phonetic-guide-box" *ngIf="currentLanguage">
        <p>{{ currentLanguage.phoneticGuide }}</p>
      </div>

      <div class="ion-margin-top">
        <ion-button
          fill="outline"
          shape="round"
          color="secondary"
          size="small"
          (click)="playAudio(1.0)">
          <ion-icon name="volume-high" slot="start"></ion-icon>
          Listen
        </ion-button>

        <ion-button
          fill="outline"
          shape="round"
          color="secondary"
          size="small"
          class="ion-margin-start"
          (click)="playAudio(0.6)">
          <ion-icon name="hourglass-outline" slot="start"></ion-icon>
          Slow
        </ion-button>
      </div>

    </div>
  </div>

  <div class="ion-padding-start ion-padding-end ion-margin-bottom">
    <ion-button expand="block" color="secondary" shape="round" class="ion-margin-top" (click)="setModalOpen(true)">
      <ion-icon name="flash" slot="start"></ion-icon>
      Quick Phrases
    </ion-button>
  </div>

  <ion-modal [isOpen]="isModalOpen" (didDismiss)="setModalOpen(false)">
    <ng-template>
      <ion-header>
        <ion-toolbar>
          <ion-title>Quick Phrases</ion-title>
          <ion-buttons slot="end">
            <ion-button (click)="setModalOpen(false)">Close</ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-header>
      <ion-content class="ion-padding">
        <ion-list lines="none">
          <ion-item *ngFor="let item of essentials" (click)="selectEssential(item)" button detail="false" class="phrase-item">
            <ion-label>
              <h2>{{ item.english }}</h2>
              <p *ngIf="item.translation" class="native-text">{{ item.translation.text }}</p>
              <p *ngIf="item.translation" class="phonetic-text">{{ item.translation.phonetic }}</p>
            </ion-label>
            <ion-icon name="chevron-forward" slot="end" color="medium"></ion-icon>
          </ion-item>
        </ion-list>
      </ion-content>
    </ng-template>
  </ion-modal>

  <div class="ion-padding-start ion-padding-end">
    <p class="section-label">1. Start Sentence</p>

    <div class="scroll-horizontal">
      <div
        *ngFor="let starter of starters"
        class="starter-card"
        [class.active]="selectedStarter?.id === starter.id"
        (click)="selectStarter(starter)">
        {{ starter.english }}
      </div>
    </div>
  </div>

  <div class="ion-padding-start ion-padding-end ion-margin-top">

    <div class="scroll-horizontal ion-margin-bottom">
      <ion-chip
        *ngFor="let cat of categories"
        [color]="selectedCategory === cat ? 'primary' : 'medium'"
        [outline]="selectedCategory !== cat"
        (click)="filterNouns(cat)">
        <ion-label>{{ cat }}</ion-label>
      </ion-chip>
    </div>

    <p class="section-label">2. Complete Phrase</p>

    <ion-grid class="ion-no-padding">
      <ion-row>
        <ion-col size="6" size-md="4" *ngFor="let noun of visibleNouns">
          <button
            class="builder-btn"
            [class.active]="selectedNoun?.id === noun.id"
            (click)="selectNoun(noun)">
            {{ noun.english }}
          </button>
        </ion-col>
      </ion-row>
    </ion-grid>

    <div class="ion-padding-bottom ion-margin-bottom"></div>
  </div>

  <div class="spacer-bottom"></div>

</ion-content>

<!-- WELCOME SCREEN OVERLAY -->
<div class="welcome-overlay" *ngIf="showWelcomeScreen">
  <div class="welcome-content">
    <div class="ion-text-center ion-margin-bottom">
      <h1 class="welcome-title">Lunar Languages</h1>
      <p class="welcome-subtitle">Choose your destination</p>
    </div>

    <div class="language-grid">
      <div
        class="language-card"
        *ngFor="let lang of availableLanguages"
        (click)="selectInitialLanguage(lang.code)">
        <div class="flag">{{ lang.flag }}</div>
        <div class="name">{{ lang.name }}</div>
      </div>
    </div>
  </div>
</div>
